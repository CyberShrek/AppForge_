{"version":3,"file":"modal-891a31fc.js","sources":["../../../../../../../typescript/util/data.ts","../../../../../../../typescript/properties.ts","../../../../../../../typescript/util/resolver.ts","../../../../../../../typescript/util/modal.ts"],"sourcesContent":["// Returns vararg items as a Set of the vararg items\nimport {Field} from \"../fragments/form/section/field/Field\"\n\nexport function setOf<T>(...items: T[]): Set<T>{\n    return new Set(items)\n}\n\n// Returns a Map of the vararg Pair entries\nexport function mapOf<K, V>(...entries: Pair<K, V>[]): Map<K, V>{\n    return new Map(entries.map(entry => [entry.first, entry.second]))\n}\n\n// Returns two arguments as a Pair object\nexport function pairOf<F, S>(first: F, second: S): Pair<F, S>{\n    return {first, second}\n}\n\n// Returns a basic number from gotten string if this is possible, or 0 if not\nexport function numberOf(word: string|number): number {\n    return isNaN(Number(word)) ? 0 : Number(word)\n}\n\n// Returns a Map consisting of the vararg Maps\nexport function concatMaps(...maps: Map<any, any>[]): Map<any, any>{\n    const buffer = []\n    maps.forEach(map => {\n        buffer.push(...map.entries())\n    })\n    return new Map(buffer)\n}\n\n// Returns sorted by key Map\nexport function sortMap<K, V>(contentMap: Map<K, V>): Map<K, V>{\n    return new Map([...contentMap.entries()].sort(\n        (a : [K, V], b : [K, V]) : number => a[0] > b[0] ? 1 : a[0] < b[0] ? -1 : 0\n    ))\n}\n\nexport function filterMap<K, V>(map: Map<K, V>, filter: (value: V, key: K) => boolean): Map<K, V> {\n    return new Map(Array.from(map).filter(([key, value]) => filter(value, key)))\n}\n\nexport function mapToJson<V>(map: Map<string, V>): {[k: string]: V} {\n    const obj: {[k: string]: V} = {}\n    map.forEach((value, key) => obj[key] = value)\n    return obj\n}\n\nexport function jsonToMap<V>(json: object): Map<string, V> {\n    const map: Map<string, V> = new Map()\n    for (const key in json) {\n        map.set(key, json[key])\n    }\n    return map\n}\n\nexport function compareMaps<K, V>(map1: Map<K, V>|null, map2: Map<K, V>|null): boolean {\n    if(map1 === null || map2 === null)\n        return map1 === map2\n\n    if (map1.size !== map2.size)\n        return false\n\n    for (const [key, value] of map1) {\n        if (!map2.has(key))\n            return false\n        if (map2.get(key) !== value)\n            return false\n    }\n\n    return true\n}\n\nexport function setToArray<T>(set: Set<T>): T[] {\n    return [...set]\n}\n\nexport function prettify<T>(value: T): string{\n    if(value === null || value === undefined)\n        return \"\"\n    if(typeof value !== \"object\")\n        return String(value)\n    if(value instanceof Set || value instanceof Array)\n        return Array.from(value).join(\", \")\n    if(value instanceof Map)\n        return [...value.entries()].map(([key, value]) => `${value} (${key})`).join(\", \")\n    if (value instanceof Date)\n        return stringifyDate(value)\n\n    return JSON.stringify(value, null, 2)\n}\n\nexport function jsonify<T>(value: T|null):  any{\n    if(value === null || value === undefined)\n        return null\n    if(typeof value !== \"object\")\n        return value\n    if(value instanceof Set)\n        return setToArray(value)\n    if(value instanceof Map)\n        return mapToJson(value)\n\n    return value\n}\n\nexport function jsonifyFields(fields: Map<FieldKey, Field<any>>): JsonProperties{\n    const json: { [key: string]: object } = {}\n    fields.forEach((field, key) => {\n        if(!field.hidden) {\n            json[key] = field.jsonValue\n        }\n    })\n    return json\n}\nexport function stringifyDate(date: Date): string {\n    const year = date.getFullYear(),\n        month = date.getMonth() + 1,\n        day = date.getDate()\n    return `${year}-${month < 10 ? '0' : ''}${month}-${day < 10 ? '0' : ''}${day}`\n}\nexport function javaSetToSet(javaSet: string): Set<string>{\n    return setOf(...splitJavaCollection(javaSet))\n}\nexport function javaMapToMap(javaMap: string): Map<string, string>{\n    return mapOf(\n        ...splitJavaCollection(javaMap)\n        .map(pair => {\n            const entry = pair.split(\"=\")\n            return pairOf(entry[0], entry[1])\n        })\n    )\n}\nexport function splitJavaCollection(javaCollection: string): string[]{\n    return javaCollection\n        .slice(1, -1) // Removing '{' and '}' in the both sides of the string\n        .split(\", \")\n}\n\nexport function transposeMatrix<T>(matrix: T[][]): T[][]{\n    return matrix[0].map((_, i) => matrix.map(row => row[i]))\n}\n\nexport const isNullOrUndefined = (value: any): boolean => value === null || value === undefined\n\nexport const valueOrDefault = <T>(value: T | any, defaultValue: T): T =>\n    isNullOrUndefined(value) ? defaultValue : value\n\nexport const valueOrError = <T>(value: T | any, errorMessage: string): T =>{\n    if(isNullOrUndefined(value)) throw new Error(errorMessage)\n    return value\n}\n\nexport function extractJsonItemsWithSuffix(json: {}, suffix: string): {}{\n    const items = {}\n    for (const key in json)\n        if(key.endsWith(suffix))\n            items[key] = json[key]\n\n    return items\n}\n","\nexport const\n    imagesLocation = \"/appforge/img/\",\n    stylesLocation = \"/appforge/css/\",\n    modulesLocation = \"/appforge/js/\"","import {modulesLocation, stylesLocation} from \"../properties\";\n\nconst\n    stylesPromises  = new Map<string, Promise<any>>(),\n    modulesPromises = new Map<string, Promise<any>>()\n\nexport const resolveCSS = (name: string) =>\n    promisePromise(name, stylesPromises, new Promise((resolve, reject) => {\n        const link = document.createElement('link')\n        link.rel     = 'stylesheet'\n        link.href    = `${stylesLocation}${name}.css`\n        link.onload  = resolve\n        link.onerror = reject\n        document.head.appendChild(link)\n    }))\n\nexport const resolveJS = (name: string) =>\n    promisePromise(name, modulesPromises, import(`${modulesLocation}${name}.js`))\n\n\nfunction promisePromise<T>(promiseName: string,\n                           promiseContainer: Map<string, Promise<any>>,\n                           promise: Promise<T>): Promise<T>{\n\n    if(!promiseContainer.has(promiseName))\n        promiseContainer.set(promiseName, promise)\n\n    return promiseContainer.get(promiseName)\n}","import swal, {SweetAlertResult} from \"sweetalert2\"\nimport {type SweetAlertOptions, type SweetAlertPosition} from \"sweetalert2\"\nimport {resolveCSS} from \"./resolver\"\n\nresolveCSS(\"third-party/sweetalert2\")\n\nlet mouseEvent: MouseEvent\ndocument.addEventListener(\"mousemove\", event => mouseEvent = event)\n\nexport function popupMessage(title?: string, text?: string){\n    popupSweetModal({title, text})\n}\n\nexport function popupList(title?: string, list?: { icon: string, text: string }[], footer?: string){\n    popupSweetModal({\n        title,\n        html:`<ul>${list.map(item => `<li style='list-style-type: \"${item.icon}\\t\"'>${item.text}</li>`).join(\"\")}</ul>`,\n        footer\n    })\n}\n\nexport function popupAction(title?: string, text?: string, confirmButtonText?: string, onConfirm?: () => void){\n    popupSweetModal({\n        title,\n        text,\n        confirmButtonText,\n        showConfirmButton: true\n    }).then(result => {\n        if(result.isConfirmed)\n            onConfirm()\n    })\n}\n\nexport function popupTimeoutAction(text?: string, confirmButtonText?: string, onConfirm?: () => void, radioOptions?: {[key: string]: string}){\n    popupSweetModal({\n        text, confirmButtonText,\n        input: radioOptions ? \"radio\" : undefined,\n        inputOptions: radioOptions ? radioOptions : undefined,\n        showConfirmButton: true,\n        timer: 3000,\n        timerProgressBar: true,\n        backdrop: false\n    }).then(result => {\n        if(result.isConfirmed)\n            onConfirm()\n    })\n}\n\nexport function popupError(title?: string, error?: Error, footer?: string){\n    popupSweetModal({title, text: error.message, icon: \"error\", footer})\n    throw error\n}\n\nexport function popupHttpDataError(error?: Error, footer?: string){\n    popupError(\"Ошибка получения данных\", error, footer)\n}\n\nfunction popupSweetModal(options: SweetAlertOptions): Promise<SweetAlertResult>{\n    const position = getSweetMousePosition()\n    return swal.fire({\n        confirmButtonColor: \"var(--primary-color)\",\n        position,\n        showClass: {popup: 'animate__animated '+getAnimationShowClass(position)},\n        hideClass: {popup: 'animate__animated animate__zoomOut'},\n        showCloseButton: true,\n        allowEnterKey: false,\n        showConfirmButton: false,\n        ...options\n    })\n}\n\nfunction getSweetMousePosition(): SweetAlertPosition{\n    if(!mouseEvent) return \"center\"\n\n    const { clientX, clientY } = mouseEvent,\n        screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\n        screenHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight,\n        horizontalPosition = clientX <= screenWidth / 3 ? 'left' : clientX >= (screenWidth / 3) * 2 ? 'right' : 'center',\n        verticalPosition = clientY <= screenHeight / 3 ? 'top' : clientY >= (screenHeight / 3) * 2 ? 'bottom' : 'center',\n        position = `${verticalPosition}-${horizontalPosition}`\n\n    return position === \"top-center\" ? \"top\" : position === \"bottom-center\" ? \"bottom\" : position as SweetAlertPosition\n}\n\nfunction getAnimationShowClass(position: SweetAlertPosition): string{\n    switch (position) {\n        case \"top-left\"     : return \"animate__fadeInTopLeft\"\n        case \"top\"          : return \"animate__fadeInDown\"\n        case \"top-right\"    : return \"animate__fadeInTopRight\"\n        case \"center-left\"  : return \"animate__fadeInLeft\"\n        case \"center\"       : return \"animate__fadeIn\"\n        case \"center-right\" : return \"animate__fadeInRight\"\n        case \"bottom-left\"  : return \"animate__fadeInBottomLeft\"\n        case \"bottom\"       : return \"animate__fadeInUp\"\n        case \"bottom-right\" : return \"animate__fadeInBottomRight\"\n        default             : return \"\"\n    }\n}"],"names":["numberOf","word","isNaN","Number","concatMaps","maps","buffer","forEach","map","push","entries","Map","filterMap","filter","Array","from","key","value","jsonToMap","json","set","compareMaps","map1","map2","size","has","get","prettify","String","Set","join","Date","stringifyDate","JSON","stringify","jsonify","obj","mapToJson","jsonifyFields","fields","field","hidden","jsonValue","date","year","getFullYear","month","getMonth","day","getDate","valueOrDefault","defaultValue","isNullOrUndefined","extractJsonItemsWithSuffix","suffix","items","endsWith","imagesLocation","stylesLocation","stylesPromises","modulesPromises","resolveCSS","name","promisePromise","Promise","resolve","reject","link","document","createElement","rel","href","onload","onerror","head","appendChild","resolveJS","import","promiseName","promiseContainer","promise","mouseEvent","popupMessage","title","text","popupSweetModal","popupList","list","footer","html","item","icon","popupAction","confirmButtonText","onConfirm","showConfirmButton","then","result","isConfirmed","popupTimeoutAction","radioOptions","input","undefined","inputOptions","timer","timerProgressBar","backdrop","popupHttpDataError","error","message","popupError","options","position","clientX","clientY","screenWidth","window","innerWidth","documentElement","clientWidth","body","screenHeight","innerHeight","clientHeight","getSweetMousePosition","swal","fire","Object","assign","confirmButtonColor","showClass","popup","getAnimationShowClass","hideClass","showCloseButton","allowEnterKey","addEventListener","event"],"mappings":"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"}