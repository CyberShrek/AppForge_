{"version":3,"file":"index.js","sources":["../../../../../../typescript/src/stylesResolver.ts","../../../../../../typescript/src/store.ts","../../../../../../typescript/src/modal.ts","../../../../../../typescript/src/api/misc.ts","../../../../../../typescript/src/core/header.ts","../../../../../../typescript/src/index.ts"],"sourcesContent":["export function resolveCSS(name: string){\n    const source = `./css/${name}.css`\n    const headElement = document.querySelector(\"head\")\n    if(headElement.querySelector(`link[href=\"${source}\"]`) === null) {\n        const styleEl = document.createElement(\"link\")\n        styleEl.setAttribute(\"rel\", \"stylesheet\")\n        styleEl.setAttribute(\"href\", source)\n        headElement.append(styleEl)\n    }\n}","export let mouseEvent: MouseEvent\ndocument.addEventListener(\"mousemove\", event => mouseEvent = event)","import swal, {SweetAlertResult} from \"sweetalert2\"\nimport {type SweetAlertOptions, type SweetAlertPosition} from \"sweetalert2\"\nimport {resolveCSS} from \"./stylesResolver\"\nimport {mouseEvent} from \"./store\"\n\nresolveCSS(\"third-party/sweetalert2\")\n\nexport function popupMessage(title?: string, text?: string){\n    popupSweetModal({title, text})\n}\n\nexport function popupList(title?: string, list?: string[], footer?: string){\n    popupSweetModal({\n        title,\n        html:`<ul>${list.map(item => `<li>${item}</li>`).join(\"\")}</ul>`,\n        footer\n    })\n}\n\nexport function popupTimeoutAction(text?: string, confirmButtonText?: string, onConfirm?: () => void){\n    popupSweetModal({\n        text, confirmButtonText,\n        showConfirmButton: true,\n        timer: 3000,\n        timerProgressBar: true,\n        backdrop: false\n    }).then(result => {\n        if(result.isConfirmed)\n            onConfirm()\n    })\n}\n\nexport function popupError(title?: string, text?: string){\n    popupSweetModal({title, text, icon: \"error\"})\n}\n\nexport function popupHttpResourceError(html?: string, footer?: string){\n    popupSweetModal({\n        title: \"Ошибка получения ресурса\",\n        icon: \"error\", html, footer\n    })\n}\n\nfunction popupSweetModal(options: SweetAlertOptions): Promise<SweetAlertResult>{\n    const position = getSweetMousePosition()\n    return swal.fire({\n        confirmButtonColor: \"var(--primary-color)\",\n        position,\n        showClass: {popup: 'animate__animated '+getAnimationShowClass(position)},\n        hideClass: {popup: 'animate__animated animate__zoomOut'},\n        showCloseButton: true,\n        allowEnterKey: false,\n        showConfirmButton: false,\n        ...options\n    })\n}\n\nfunction getSweetMousePosition(): SweetAlertPosition{\n    const { clientX, clientY } = mouseEvent,\n        screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\n        screenHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight,\n        horizontalPosition = clientX <= screenWidth / 3 ? 'left' : clientX >= (screenWidth / 3) * 2 ? 'right' : 'center',\n        verticalPosition = clientY <= screenHeight / 3 ? 'top' : clientY >= (screenHeight / 3) * 2 ? 'bottom' : 'center',\n        position = `${verticalPosition}-${horizontalPosition}`\n\n    return position === \"top-center\" ? \"top\" : position === \"bottom-center\" ? \"bottom\" : position as SweetAlertPosition\n}\n\nfunction getAnimationShowClass(position: SweetAlertPosition): string{\n    switch (position) {\n        case \"top-left\"     : return \"animate__fadeInTopLeft\"\n        case \"top\"          : return \"animate__fadeInDown\"\n        case \"top-right\"    : return \"animate__fadeInTopRight\"\n        case \"center-left\"  : return \"animate__fadeInLeft\"\n        case \"center\"       : return \"animate__fadeIn\"\n        case \"center-right\" : return \"animate__fadeInRight\"\n        case \"bottom-left\"  : return \"animate__fadeInBottomLeft\"\n        case \"bottom\"       : return \"animate__fadeInUp\"\n        case \"bottom-right\" : return \"animate__fadeInBottomRight\"\n        default             : return \"\"\n    }\n}","import wretch from \"wretch\"\nimport {popupHttpResourceError} from \"../modal\"\nimport {AppInfo} from \"../entities/AppInfo\"\n\nexport const fetchApplicationInfo=(): Promise<AppInfo|null> =>\n    wretch(\"../info\")\n        .get()\n        .res(response => response.body as AppInfo)\n        .catch(errorBody => {\n            popupHttpResourceError(errorBody, \"Не удалось загрузить информацию о приложении\")\n            return null\n        })\n","import {resolveCSS} from \"../stylesResolver\"\nimport {popupError, popupList, popupTimeoutAction} from \"../modal\"\nimport {fetchApplicationInfo} from \"../api/misc\"\nimport {text} from \"stream/consumers\";\n\nexport function resolveHeader(){\n    resolveCSS(\"header\")\n    resolveResetButton()\n    resolveInfoButton()\n    resolveHelpButton()\n}\n\nconst headerElement = document.getElementById(\"header\")!\n\nfunction resolveResetButton(){\n    resolveButtonAction(\"reset\", () => location.reload())\n}\n\nfunction resolveInfoButton(){\n    resolveButtonAction(\"info\", () => {\n        fetchApplicationInfo().then(appInfo => {\n            if(appInfo){popupList(\n                \"Информация о приложении\",\n                [\n                    \"Версия программы: \"+appInfo.version,\n                    \"Дата последнего обновления: \"+appInfo.updateDate,\n                    \"Технолог: \"+appInfo.technologistName\n                ])\n            }\n        })\n    })\n}\n\nfunction resolveHelpButton(){\n    resolveButtonAction(\"help\", () => {\n        popupTimeoutAction(\n            \"Руководство\",\n            \"Скачать инструкцию\",\n            downloadUserManual\n        )\n    })\n}\n\nfunction downloadUserManual(){\n    const link = document.createElement('a')\n    link.href = `n/d`\n    link.target = '_blank'\n    document.body.appendChild(link)\n    link.click()\n    document.body.removeChild(link)\n}\n\nfunction resolveButtonAction(buttonClassName: string, onClick: () => void){\n    headerElement.querySelector(\"button.\"+buttonClassName).addEventListener(\"click\", onClick)\n}","import {resolveHeader} from \"./core/header\"\nimport {resolveCSS} from \"./stylesResolver\"\n\nresolveCSS(\"global\")\nresolveCSS(\"inputs\")\nresolveCSS(\"states\")\nresolveCSS(\"third-party/animate\")\n\nresolveHeader()"],"names":["resolveCSS","name","source","headElement","document","querySelector","styleEl","createElement","setAttribute","append","mouseEvent","popupSweetModal","options","position","clientX","clientY","screenWidth","window","innerWidth","documentElement","clientWidth","body","screenHeight","innerHeight","clientHeight","getSweetMousePosition","swal","fire","Object","assign","confirmButtonColor","showClass","popup","getAnimationShowClass","hideClass","showCloseButton","allowEnterKey","showConfirmButton","addEventListener","event","fetchApplicationInfo","wretch","get","res","response","catch","errorBody","title","icon","html","footer","headerElement","getElementById","downloadUserManual","link","href","target","appendChild","click","removeChild","resolveButtonAction","buttonClassName","onClick","location","reload","then","appInfo","list","version","updateDate","technologistName","map","item","join","onConfirm","text","confirmButtonText","timer","timerProgressBar","backdrop","result","isConfirmed"],"mappings":"uFAAM,SAAUA,EAAWC,GACvB,MAAMC,EAAS,SAASD,QAClBE,EAAcC,SAASC,cAAc,QAC3C,GAA2D,OAAxDF,EAAYE,cAAc,cAAcH,OAAsB,CAC7D,MAAMI,EAAUF,SAASG,cAAc,QACvCD,EAAQE,aAAa,MAAO,cAC5BF,EAAQE,aAAa,OAAQN,GAC7BC,EAAYM,OAAOH,EACtB,CACL,CCTO,IAAII,EC2CX,SAASC,EAAgBC,GACrB,MAAMC,EAaV,WACI,MAAMC,QAAEA,EAAOC,QAAEA,GAAYL,EACzBM,EAAcC,OAAOC,YAAcd,SAASe,gBAAgBC,aAAehB,SAASiB,KAAKD,YACzFE,EAAeL,OAAOM,aAAenB,SAASe,gBAAgBK,cAAgBpB,SAASiB,KAAKG,aAG5FX,EAAW,GADQE,GAAWO,EAAe,EAAI,MAAQP,GAAYO,EAAe,EAAK,EAAI,SAAW,YADnFR,GAAWE,EAAc,EAAI,OAASF,GAAYE,EAAc,EAAK,EAAI,QAAU,WAI5G,MAAoB,eAAbH,EAA4B,MAAqB,kBAAbA,EAA+B,SAAWA,CACzF,CAtBqBY,GACjB,OAAOC,EAAKC,KAAIC,OAAAC,OAAA,CACZC,mBAAoB,uBACpBjB,WACAkB,UAAW,CAACC,MAAO,qBAAqBC,EAAsBpB,IAC9DqB,UAAW,CAACF,MAAO,sCACnBG,iBAAiB,EACjBC,eAAe,EACfC,mBAAmB,GAChBzB,GAEX,CAaA,SAASqB,EAAsBpB,GAC3B,OAAQA,GACJ,IAAK,WAAiB,MAAO,yBAC7B,IAAK,MAAiB,MAAO,sBAC7B,IAAK,YAAiB,MAAO,0BAC7B,IAAK,cAAiB,MAAO,sBAC7B,IAAK,SAAiB,MAAO,kBAC7B,IAAK,eAAiB,MAAO,uBAC7B,IAAK,cAAiB,MAAO,4BAC7B,IAAK,SAAiB,MAAO,oBAC7B,IAAK,eAAiB,MAAO,6BAC7B,QAAsB,MAAO,GAErC,CDhFAT,SAASkC,iBAAiB,aAAaC,GAAS7B,EAAa6B,ICI7DvC,EAAW,2BCDJ,MAAMwC,EAAqB,IAC9BC,EAAO,WACFC,MACAC,KAAIC,GAAYA,EAASvB,OACzBwB,OAAMC,ID6BXnC,EAAgB,CACZoC,MAAO,2BACPC,KAAM,QAASC,KC9BYH,ED8BNI,OC9BiB,iDAC3B,QCEnB,MAAMC,EAAgB/C,SAASgD,eAAe,UA+B9C,SAASC,IACL,MAAMC,EAAOlD,SAASG,cAAc,KACpC+C,EAAKC,KAAO,MACZD,EAAKE,OAAS,SACdpD,SAASiB,KAAKoC,YAAYH,GAC1BA,EAAKI,QACLtD,SAASiB,KAAKsC,YAAYL,EAC9B,CAEA,SAASM,EAAoBC,EAAyBC,GAClDX,EAAc9C,cAAc,UAAUwD,GAAiBvB,iBAAiB,QAASwB,EACrF,CCnDA9D,EAAW,UACXA,EAAW,UACXA,EAAW,UACXA,EAAW,uBDAPA,EAAW,UASX4D,EAAoB,SAAS,IAAMG,SAASC,WAI5CJ,EAAoB,QAAQ,KACxBpB,IAAuByB,MAAKC,QFTVnB,EAAgBoB,EAAiBjB,EEU5CgB,IFVWnB,EEWV,0BFX0BoB,EEY1B,CACI,qBAAqBD,EAAQE,QAC7B,+BAA+BF,EAAQG,WACvC,aAAaH,EAAQI,kBFdrC3D,EAAgB,CACZoC,QACAE,KAAK,OAAOkB,EAAKI,KAAIC,GAAQ,OAAOA,WAAaC,KAAK,WACtDvB,WEaK,GACH,IAKNU,EAAoB,QAAQ,SFf8Cc,IEmBlErB,EFlBR1C,EAAgB,CACZgE,KEeI,cFfEC,kBEgBF,qBFfJvC,mBAAmB,EACnBwC,MAAO,IACPC,kBAAkB,EAClBC,UAAU,IACXd,MAAKe,IACDA,EAAOC,aACNP,GAAW,GEWd"}