import{r as t}from"./index.js";import{s as e,i as s,a as r,n as i,t as n}from"./easepick-abdaa5ad.js";import{c as o}from"./modal-a5a8d558.js";import"./sweetalert2-f9822954.js";function c(t){return isNaN(Number(t))?0:Number(t)}function a(t){const e=t.getFullYear(),s=t.getMonth()+1,r=t.getDate();return`${e}-${s<10?"0":""}${s}-${r<10?"0":""}${r}`}const d=new Event("update");new Event("mount");class l{constructor(t,e){this.core=t,this.section=e,this.dispatchUpdate=()=>this.core.dispatchEvent(d)}subscribeOnFields(t,e){t.forEach((t=>this.subscribeOnField(t.first,t.second,e)))}subscribeOnField(t,e,s){const r=this.findFieldOrThrowError(t,e);r.core.addEventListener(d.type,(()=>s(r.value)))}findFieldOrThrowError(t,e){const s=this.section.form.sections.get(t);if(!s)throw Error(`Не удалось найти секцию с ключом "${t}"`);const r=s.fields.get(e);if(!r)throw Error(`Не удалось найти поле с ключом "${t}.${e}"`);return r}}t("third-party/easepick");class h extends l{constructor(t,o){var d,l;super(t,o),this.core=t,this.section=o,d=t,l=(t,e)=>{this.value={start:a(t),end:a(e)},this.dispatchUpdate()},new e.create({element:d,format:"DD.MM.YYYY",calendars:2,grid:2,zIndex:100,plugins:[s,r,i],lang:"ru",AmpPlugin:{darkMode:!1,resetButton:!0,dropdown:{minYear:2010,maxYear:null,months:!0,years:!0}},RangePlugin:{startDate:new n,endDate:new n,locale:{one:"день",few:"дня",many:"дней"},delimiter:" - "},LockPlugin:{minDays:1,maxDays:c(d.getAttribute("max-days"))},css:["css/third-party/easepick.css"],setup(t){t.on("select",(e=>{l(e.detail.start,e.detail.end),setTimeout((()=>t.hide()),10)}))}})}}class u extends l{constructor(t,e){super(t,e),this.core=t,this.section=e,e.form.onMount=()=>{this.subscribeOnField("period","range",(t=>o("Выбрано",t)))}}}class m extends l{constructor(t,e){super(t,e),this.core=t,this.section=e}}class p{constructor(t,e){this.core=t,this.form=e,this.fields=new Map}}class f extends p{constructor(t,e){super(t,e),this.core=t,this.form=e,t.querySelectorAll(".field").forEach((t=>this.fields.set(t.getAttribute("key"),this.defineField(t))))}defineField(t){return t.classList.contains("datepicker")?new h(t,this):t.classList.contains("select")?new u(t,this):t.classList.contains("checkbox")?new m(t,this):void 0}}class w{constructor(t){this.core=t,this.sections=new Map,this.mount=()=>this.onMount()}}t("main-form");class g extends w{constructor(t){super(t),this.core=t,t.querySelectorAll(".section").forEach((t=>this.sections.set(t.getAttribute("key"),new f(t,this)))),this.mount()}}export{g as default};
//# sourceMappingURL=MainForm-734db164.js.map
