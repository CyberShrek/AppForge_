{"version":3,"file":"Header-986ccf52.js","sources":["../../../../../../../typescript/fragments/header/Header.ts","../../../../../../../typescript/utils/api/appMetaData.ts"],"sourcesContent":["import {resolveCSS} from \"../../utils/resolver\"\nimport {downloadUserManual, fetchAppMetaData} from \"../../utils/api/appMetaData\"\nimport {popupList, popupTimeoutAction} from \"../../utils/modal\"\nimport {Fragment} from \"../abstract/Fragment\"\n\nexport default class Header extends Fragment{\n\n    private appMetaData: AppMetaData\n\n    constructor(location: FragmentLocation) {\n        super(location)\n        this.core = location.target\n        resolveCSS(\"header\")\n        fetchAppMetaData().then(data => {\n            this.appMetaData = data\n        })\n        this.activateResetButton()\n        this.activateInfoButton()\n        this.activateHelpButton()\n    }\n\n    private activateResetButton(){\n        this.activateButton(\"reset\", () => location.reload())\n    }\n\n    private activateInfoButton(){\n        this.activateButton(\"info\", () => {\n            popupList(\n                \"Информация о приложении\",\n                [\n                    \"Версия программы: \"          + this.appMetaData?.version,\n                    \"Дата последнего обновления: \"+ this.appMetaData?.updateDate,\n                    \"Технолог: \"                  + this.appMetaData?.technologistName\n                ])})\n    }\n\n    private activateHelpButton(){\n        this.activateButton(\"help\", () => {\n            popupTimeoutAction(\n                \"Руководство\",\n                \"Скачать инструкцию\",\n                () => downloadUserManual(this.appMetaData.manualPath)\n            )\n        })\n    }\n\n    private activateButton(buttonClassName: string, onClick: () => void){\n        this.core.querySelector(\"button.\"+buttonClassName).addEventListener(\"click\", onClick)\n    }\n}","import wretch from \"wretch\"\nimport {popupHttpDataError} from \"../modal\"\n\nexport const fetchAppMetaData=(): Promise<AppMetaData|null> =>\n    wretch(\"baggages/info\")\n        .get()\n        .json(json => json as AppMetaData)\n        .catch(errorBody => {\n            popupHttpDataError(errorBody, \"Не удалось загрузить информацию о приложении\")\n            return null\n        })\n\nexport function downloadUserManual(href){\n    const link = document.createElement('a')\n    link.href = href\n    link.target = '_blank'\n    document.body.appendChild(link)\n    link.click()\n    document.body.removeChild(link)\n}"],"names":["Header","Fragment","constructor","location","super","this","core","target","resolveCSS","wretch","get","json","catch","errorBody","popupHttpDataError","then","data","appMetaData","activateResetButton","activateInfoButton","activateHelpButton","activateButton","reload","popupList","_a","version","_b","updateDate","_c","technologistName","popupTimeoutAction","href","link","document","createElement","body","appendChild","click","removeChild","downloadUserManual","manualPath","buttonClassName","onClick","querySelector","addEventListener"],"mappings":"0KAKqB,MAAAA,UAAeC,EAIhCC,YAAYC,GACRC,MAAMD,GACNE,KAAKC,KAAOH,EAASI,OACrBC,EAAW,UCRfC,EAAO,iBACFC,MACAC,MAAKA,GAAQA,IACbC,OAAMC,IACHC,EAAmBD,EAAW,gDACvB,QDIQE,MAAKC,IACpBX,KAAKY,YAAcD,CAAI,IAE3BX,KAAKa,sBACLb,KAAKc,qBACLd,KAAKe,oBACR,CAEOF,sBACJb,KAAKgB,eAAe,SAAS,IAAMlB,SAASmB,UAC/C,CAEOH,qBACJd,KAAKgB,eAAe,QAAQ,eACxBE,EACI,0BACA,CACI,sBAAgD,QAAhBC,EAAAnB,KAAKY,mBAAW,IAAAO,OAAA,EAAAA,EAAEC,SAClD,gCAAgD,QAAhBC,EAAArB,KAAKY,mBAAW,IAAAS,OAAA,EAAAA,EAAEC,YAClD,cAAgD,QAAhBC,EAAAvB,KAAKY,mBAAW,IAAAW,OAAA,EAAAA,EAAEC,mBACpD,GACb,CAEOT,qBACJf,KAAKgB,eAAe,QAAQ,KACxBS,EACI,cACA,sBACA,IC7BV,SAA6BC,GAC/B,MAAMC,EAAOC,SAASC,cAAc,KACpCF,EAAKD,KAAOA,EACZC,EAAKzB,OAAS,SACd0B,SAASE,KAAKC,YAAYJ,GAC1BA,EAAKK,QACLJ,SAASE,KAAKG,YAAYN,EAC9B,CDsBsBO,CAAmBlC,KAAKY,YAAYuB,aAC7C,GAER,CAEOnB,eAAeoB,EAAyBC,GAC5CrC,KAAKC,KAAKqC,cAAc,UAAUF,GAAiBG,iBAAiB,QAASF,EAChF"}