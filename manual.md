# AppForge

AppForge представляет собой микросервис, развертываемый на сервере приложений и предлагающий простой API для создания типовых веб-приложений. В настоящее время он ориентирован на создание приложений для автоматического составления отчетов и визуализации данных.

### Общая схема работы

1. Произвольное веб-приложение возвращает авторизированному пользователю HTML-документ. Этот документ содержит конфигурацию создаваемого приложения и ссылку на специальный JavaScript-модуль.
2. JavaScript-модуль загружается из бэкенда AppForge и строит представление согласно полученной конфигурации:
   1. Сразу после загрузки инициализационного JavaScript-модуля, AppForge делает запрос в UserCheck по коду приложения, указанному в конфигурации. Цель этого запроса - получить информацию о том, какие данные доступны пользователю.
   2. Если UserCheck подтверждает доступ, клиенту загружаются необходимые модули для создания полностью готового клиентского приложения.

Клиентское приложение, сформированное AppForge, содержит:
- навигационную панель (оглавление) с данными из PrilInfo
- формы ввода параметров, активно обменивающиеся данными по HTTP с бэкендом приложения и банком микросервисов
- ассоциированные слоты для вывода отчетов

[Демонстрационные примеры](#demos)
___

## Руководство

- [Внедрение](#appForgeInject)
- [Конфигурирование приложения](#appConfig)

## <span id="appForgeInject">Внедрение</span>

Для того, чтобы внедрить AppForge в проект, потребуется выполнить два шага:

###### 1) В ресурсах проекта создаём HTML-файл (например, index.html) и просто копируем и вставляем в него следующее содержание:

```html
<!DOCTYPE html>
<html lang="ru">

<!-- Оглавление документа. Заполняется средствами AppForge, поэтому достаточно лишь указать кодировку -->
<head>
   <meta charset="utf-8">
</head>

<!-- Блок с исполняемым js-кодом. Содержит конфигурацию, при необходимости можно прописать дополнительные инструкции -->
<script>
   // Конфигурация приложения
   config = {
       
   } 
</script>

<!-- Внешний AppForge-модуль. Загрузится браузером автоматически, ничего дополнять здесь не потребуется -->
<script type="module" src="/appforge/js/built/forge.ts">
</script>

</html>
```


###### 2) Создаём эндпоинт, возвращающий этот документ:

Пример с использованием Spring:
```java
@Controller
public class AppForgeController {

    @GetMapping("/index")
    public String appForge() {
        return "index.html";
    }
}
```

Пример с чистым Servlet:
```java
public class AppForgeServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        request.getRequestDispatcher("/index.html").forward(request, response);
    }
}
```
После этого проверяем созданный эндпоинт: если он работает корректно и возвращает наш HTML-документ по GET-запросу, то AppForge успешно внедрён. Можно начинать конфигурировать приложение.

## <span id="appConfig">Конфигурирование приложения</span>

Конфигурация приложения, она же переменная config в HTML-документе, является структурой JSON с рядом параметров, влияющих на то, каким получится приложение.
> При необходимости и должном знании JavaScript возможно использовать в качестве конфигурации настоящий JS-объект.

Краткое описание (и одновременно — пример) этой конфигурации выглядит следующим образом:


___
## <span id="demos">Демо</span>